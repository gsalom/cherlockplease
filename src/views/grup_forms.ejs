<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title><%= title %></title>
  <%- include("partials/head") %>
  <!-- Custom CSS 
   <link rel="stylesheet" href="/css/prova.css" />-->
  <script>
    function loadTutors() {
      var xhttp = new XMLHttpRequest();
      xhttp.onload = function () {
        depts = JSON.parse(this.responseText);
        depts.forEach(function (d) {
          var told=document.getElementById("tutorold").value
          if (d.codi==told) {
          document.getElementById("lista1").innerHTML+=('<option selected value=' + d.codi.toString() + '>' + d.tutor + '</option>');
          }
          else {
            document.getElementById("lista1").innerHTML+=('<option value=' + d.codi.toString() + '>' + d.tutor + '</option>');

          }
        });
      };
      xhttp.open("GET", "./ltutors", true);
      xhttp.send();
    }
    function loadAules() {
      var xhttp = new XMLHttpRequest();
      xhttp.onload = function () {
        depts = JSON.parse(this.responseText);
        depts.forEach(function (d) {
          var aold=document.getElementById("aulaold").value
          if (d.codi==aold) {
          document.getElementById("lista2").innerHTML+=('<option selected value=' + d.codi.toString() + '>' + d.nom + '</option>');
          }
          else {
            document.getElementById("lista2").innerHTML+=('<option value=' + d.codi.toString() + '>' + d.nom + '</option>');

          }
        });
      };
      xhttp.open("GET", "./laules", true);
      xhttp.send();
    }
 
    function loadSelects() {
      loadAules();
      loadTutors();
    }

    function tanca() {
      window.close();
    }

  </script>
</head>

<body onload="loadSelects()">
  <!-- HEADER -->
  <%- include("partials/navigationbackend") %>
  <!-- My Content -->
  <main class="container pt-2 text-center justify-content-center align-items-center vh-100" style="auto">
    <section>
      <h2 class="display-1">Formulari Edici√≥ Grups</h2>
      <form target="_parent" action="/grup_Update" method="get">
        <div class="bordeoutset">
          <div id="codi">
            <label for="codi">Codi GestIB:</label>
            <input type="hidden" id="id" name="id" value="<%= data[0].id_grup %>">
            <input type="text" id="codi" name="codi" readonly value="<%= data[0].codi %>" required>
          </div>
          <div id="curs"><label for="curs">Curs:</label>
            <input type="text" id="curs" name="curs" readonly value="<%= data[0].curs %>" required>
          </div>
          <div id="cicle"><label for="cicle">Cicle:</label>
            <input type="text" id="cicle" name="cicle" readonly value="<%= data[0].id_cicle %>" required>
          </div>
          <div id="nom"><label for="nom">Nom:</label>
            <input type="text" id="nom" name="nom" readonly value="<%= data[0].nom %>" required>
          </div>
          <div id="tutor"><label for="tutor">Tutor:</label>
            <input type="hidden" id="tutorold" value="<%= data[0].id_tutor %>" required>
            <select id="lista1" name="tutor" required>
              <option id="opllista" value="">Seleccioni:</option>
            </select>
          </div>
          <div id="aula"><label for="aula">Aula:</label>
            <input type="hidden" id="aulaold" value="<%= data[0].aula %>" required>
            <select id="lista2" name="aula" required>
              <option id="opllista" value="">Seleccioni:</option>
            </select>
          </div>
          <div id="estat"><label for="estat">Estat:</label>
            <input type="text" id="estat" name="estat" value="<%= data[0].estat %>" required>
          </div>
        </div><br>
        <div class="button">
          <input type="submit" value="Modificar">
          <button type="button" onclick="tanca()">Tancar</button>
        </div>
      </form>
    </section>
  </main>
</body>
</html>